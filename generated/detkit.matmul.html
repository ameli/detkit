


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta property="og:title" content="matmul" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://ameli.github.io/generated/detkit.matmul.html" />
<meta property="og:site_name" content="DetKit" />
<meta property="og:image" content="https://raw.githubusercontent.com/ameli/detkit/main/docs/source/_static/images/icons/logo-detkit-light.svg" />
<meta property="og:image:alt" content="DetKit" />
<meta property="og:title" content="DetKit">
<meta property="og:description" content="DetKit is a python package to compute some common functions involving determinant of matrices used in machine learning.">

    <title>matmul &#8212; detkit Manual</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom-pydata.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/toggleprompt.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/custom-pydata.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/custom-pydata.css"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="electrocardiogram" href="detkit.electrocardiogram.html" />
    <link rel="prev" title="solve_triangular" href="detkit.solve_triangular.html" />
    <script defer data-domain="docs.scipy.org" src="https://views.scientific-python.org/js/script.js"></script>

    <!-- My custom JS -->
    <script type="text/javascript" src="../_static/js/custom-pydata.js"></script>

    <!-- Syntax highlighting for BibTex code blocks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-solarizedlight.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs-bibtex@2.0.1/prism-bibtex.min.js"></script>

    
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="auto">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/images/icons/logo-detkit-light.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/images/icons/logo-detkit-dark.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install/install.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../docker.html">
  Docker
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../benchmark.html">
  Benchmark
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/ameli/detkit" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/detkit/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://anaconda.org/s-ameli/detkit" rel="noopener" target="_blank" title="Anaconda Cloud"><span><i class="fa fa-circle-notch"></i></span>
            <label class="sr-only">Anaconda Cloud</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://hub.docker.com/r/sameli/detkit" rel="noopener" target="_blank" title="Docker Hub"><span><i class="fab fa-docker"></i></span>
            <label class="sr-only">Docker Hub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://mybinder.org/v2/gh/ameli/detkit/HEAD?filepath=notebooks%2FInterpolateTraceOfInverse.ipynb" rel="noopener" target="_blank" title="Lanuch Jupyter on Binder"><span><i class="fas fa-book-open"></i></span>
            <label class="sr-only">Lanuch Jupyter on Binder</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Matrix Determinant
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.logdet.html">
   logdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.loggdet.html">
   loggdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.logpdet.html">
   logpdet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.memdet.html">
   memdet
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Supplementary
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.orthogonalize.html">
   orthogonalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.ortho_complement.html">
   ortho_complement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.lu_factor.html">
   lu_factor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.ldl_factor.html">
   ldl_factor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.cho_factor.html">
   cho_factor
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solving Linear Systems
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.lu_solve.html">
   lu_solve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.ldl_solve.html">
   ldl_solve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.cho_solve.html">
   cho_solve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.solve_triangular.html">
   solve_triangular
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  BLAS Operations
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   matmul
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.electrocardiogram.html">
   electrocardiogram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.covariance_matrix.html">
   covariance_matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.design_matrix.html">
   design_matrix
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Profiling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.Memory.html">
   detkit.Memory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.Disk.html">
   detkit.Disk
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.Profile.html">
   detkit.Profile
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Profiling Utilities
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.get_config.html">
   get_config
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.get_instructions_per_task.html">
   get_instructions_per_task
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.get_processor_name.html">
   get_processor_name
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.human_readable_time.html">
   human_readable_time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detkit.human_readable_mem.html">
   human_readable_mem
  </a>
 </li>
</ul>

    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detkit.matmul">
   <code class="docutils literal notranslate">
    <span class="pre">
     matmul()
    </span>
   </code>
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      

<div class="tocsection editthispage">
    <a href="https://github.com/ameli/detkit/edit/main/docs/source/generated/detkit.matmul.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="matmul">
<h1>matmul<a class="headerlink" href="#matmul" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="detkit.matmul">
<span class="sig-prename descclassname"><span class="pre">detkit.</span></span><span class="sig-name descname"><span class="pre">matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#detkit.matmul" title="Permalink to this definition">#</a></dt>
<dd><p>Matrix-matrix multiplication for sub-matrices.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>A</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A rectangular matrix with either <code class="docutils literal notranslate"><span class="pre">float64</span></code> or <code class="docutils literal notranslate"><span class="pre">float32</span></code> data type
stored with column-major ordering.</p>
</dd>
<dt><strong>A</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A rectangular matrix with either <code class="docutils literal notranslate"><span class="pre">float64</span></code> or <code class="docutils literal notranslate"><span class="pre">float32</span></code> data type
stored with column-major ordering.</p>
</dd>
<dt><strong>B</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A rectangular matrix with either <code class="docutils literal notranslate"><span class="pre">float64</span></code> or <code class="docutils literal notranslate"><span class="pre">float32</span></code> data type
stored with row-major or column-major ordering.</p>
</dd>
<dt><strong>shape</strong><span class="classifier">tuple, default=None</span></dt><dd><p>A tuple of size three, determining the shape of an upper-left
sub-matrices of <cite>A</cite>, <cite>B</cite>, and <cite>C</cite> to be referenced. Namely, if
<code class="docutils literal notranslate"><span class="pre">shape</span></code> is given as the tuple <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">k)</span></code>, then</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of rows of <span class="math notranslate nohighlight">\(\mathrm{op}(\mathbf{A})\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of columns of <span class="math notranslate nohighlight">\(\mathrm{op}(\mathbf{A})\)</span>,
which is also the number of rows of <span class="math notranslate nohighlight">\(\mathrm{op}(\mathbf{B})\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> is the number of columns of <span class="math notranslate nohighlight">\(\mathrm{op}(\mathbf{C})\)</span>.</p></li>
</ul>
<p>As such the following sub-matrices are used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A[:m,</span> <span class="pre">:n]</span></code> (or <code class="docutils literal notranslate"><span class="pre">A[:n,</span> <span class="pre">:m]</span></code> when <code class="docutils literal notranslate"><span class="pre">trans_a=True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B[:n,</span> <span class="pre">:k]</span></code> (or <code class="docutils literal notranslate"><span class="pre">B[:k,</span> <span class="pre">:n]</span></code> when <code class="docutils literal notranslate"><span class="pre">trans_b=True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C[:m,</span> <span class="pre">:k]</span></code></p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">shape</span></code> is <cite>None</cite>, the full shape of <code class="docutils literal notranslate"><span class="pre">A[:,</span> <span class="pre">:]</span></code>,
<code class="docutils literal notranslate"><span class="pre">B[:,</span> <span class="pre">:]</span></code>, and <code class="docutils literal notranslate"><span class="pre">C[:,</span> <span class="pre">:]</span></code> are considered provided that their shapes
are compatible for the matrix product.</p>
</dd>
<dt><strong>trans_a</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>False</cite>, the operator <span class="math notranslate nohighlight">\(\operatorname{op}(\mathbf{A}) =
\mathbf{A}\)</span> is used. If <cite>True</cite>, the operator
<span class="math notranslate nohighlight">\(\operatorname{op}(\mathbf{A}) = \mathbf{A}^{\intercal}\)</span> is
used.</p>
</dd>
<dt><strong>trans_ab</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>False</cite>, the operator <span class="math notranslate nohighlight">\(\operatorname{op}(\mathbf{B}) =
\mathbf{B}\)</span> is used. If <cite>True</cite>, the operator
<span class="math notranslate nohighlight">\(\operatorname{op}(\mathbf{B}) = \mathbf{B}^{\intercal}\)</span> is
used.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float, default=1</span></dt><dd><p>The parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
</dd>
<dt><strong>beta</strong><span class="classifier">float, default=0</span></dt><dd><p>The parameter <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">bool, default=False</span></dt><dd><p>If <cite>True</cite>, the output <cite>C</cite> is overwritten to the input <cite>C</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is set to <cite>True</cite>, the input matrix <cite>C</cite> should
have column-major (Fortran) ordering.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>C</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>A 2D matrix of the same shape as the input matrix <cite>C</cite> (and not the
shape of the sub-matrix). The upper-left sub-matrix of <cite>C</cite> contains
the matrix-matrix multiplication corresponding to the sub-matrices
determined by the <code class="docutils literal notranslate"><span class="pre">shape</span></code> argument. If <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is
set to <cite>True</cite>, the output matrix <cite>C</cite> is becomes a view for the matrix
<cite>C</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="detkit.solve_triangular.html#detkit.solve_triangular" title="detkit.solve_triangular"><code class="xref py py-obj docutils literal notranslate"><span class="pre">detkit.solve_triangular</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><strong>Matrix-matrix multiplication of sub-matrices:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{A}_{[:m,:n]}\)</span> denote the sub-matrix of the size
<span class="math notranslate nohighlight">\(m \times n\)</span> to be the upper-left corner of matrix
<span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. Given matrices <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>,
<span class="math notranslate nohighlight">\(\mathbf{B}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> and parameters <span class="math notranslate nohighlight">\(\alpha\)</span>
and <span class="math notranslate nohighlight">\(\beta\)</span>, this function computes</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}_{[:m, :k]} =
\alpha \operatorname{op}(\mathbf{A})_{[:m, :n]}
\operatorname{op}(\mathbf{B})_{[:n, :k]} +
\beta \mathbf{C}_{[:m, :k]},\]</div>
<p>if <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <cite>False</cite>, or</p>
<div class="math notranslate nohighlight">
\[\mathbf{C}_{[:m, :k]} \leftarrow
\alpha \operatorname{op}(\mathbf{A})_{[:m, :n]}
\operatorname{op}(\mathbf{B})_{[:n, :k]} +
\beta \mathbf{C}_{[:m, :k]},\]</div>
<p>if <code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <cite>True</cite>.</p>
<p><strong>Interpreting the output matrix:</strong></p>
<p>The shape of the output variable <cite>X</cite> is the same as the shape of
<cite>C</cite>, even if a smaller sub-matrix is considered. Regardless, only the
corresponding upper-left sub-matrix of <cite>X</cite> has meaningful data. Namely, if
<code class="docutils literal notranslate"><span class="pre">shape=(m,</span> <span class="pre">n,</span> <span class="pre">k)</span></code>, the slice <code class="docutils literal notranslate"><span class="pre">X[:m,</span> <span class="pre">:k]</span></code> should be considered as the
result. As such, the relation</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">X[:m,</span> <span class="pre">:k]</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">A[:m,</span> <span class="pre">:n]</span> <span class="pre">&#64;</span> <span class="pre">[:n,</span> <span class="pre">:k]</span> <span class="pre">+</span> <span class="pre">beta</span> <span class="pre">*</span> <span class="pre">C[:m,</span> <span class="pre">:k]</span></code></p>
</div></blockquote>
<p>or, for instance,</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">X[:m,</span> <span class="pre">:k]</span> <span class="pre">=</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">A[:n,</span> <span class="pre">:m].T</span> <span class="pre">&#64;</span> <span class="pre">[:k,</span> <span class="pre">:n].T</span> <span class="pre">+</span> <span class="pre">beta</span> <span class="pre">*</span> <span class="pre">C[:m,</span> <span class="pre">:k]</span></code></p>
</div></blockquote>
<p>(when <code class="docutils literal notranslate"><span class="pre">trans_a</span></code> and <code class="docutils literal notranslate"><span class="pre">trans_b</span></code> are <cite>True</cite>) should hold.</p>
<p><strong>Comparison with numpy.matmul:</strong></p>
<p>To perfron matrix-matrix multiplication for a sub-matrix of the input
matrices using <code class="docutils literal notranslate"><span class="pre">numpy.matmul</span></code> function (or any other similar matrix
multiplication functions), you should pass a slice of the matrix to the
function. This approach is not memory-efficient since the sliced array
allocates new memory.</p>
<p>In contrast, using <code class="docutils literal notranslate"><span class="pre">detkit.matmul</span></code> together with the <code class="docutils literal notranslate"><span class="pre">shape</span></code> argument,
no memory slice is created during the inner computation, rather, the data
from the original input matrix is accessed efficiently.</p>
<p><strong>Implementation:</strong></p>
<p>This function is a wrapper around LAPACKâ€™s <code class="docutils literal notranslate"><span class="pre">sgemm</span></code> (for 32-bit
precision) and <code class="docutils literal notranslate"><span class="pre">dgemm</span></code> (for 64-bit precision).</p>
<p>This function is internally used for <a class="reference internal" href="detkit.memdet.html#detkit.memdet" title="detkit.memdet"><code class="xref py py-func docutils literal notranslate"><span class="pre">detkit.memdet()</span></code></a> for efficient
computation of matrix determinant under memory constraint.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.netlib.org/lapack">LAPACK</a></p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">detkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">matmul</span><span class="p">,</span> <span class="n">Memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create random matrices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make sure arrays have column-ordering</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 32-bit precision data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get a copy of C (for the purpose of comparison) since we will</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># overwrite C</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C_copy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Choose size of sub-matrices that are smaller or equal to p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">700</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Track memory allocation to check if matmul operation is not</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># creating any new memory.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mem</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mem</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform matrix-matrix multiplication for sub-matrices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
</span><span class="hll"><span class="gp">... </span>           <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check peak memory allocation (compared to memory of a sum-matrix)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slice_nbytes</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mem</span><span class="o">.</span><span class="n">peak</span><span class="p">()</span> <span class="o">/</span> <span class="n">slice_nbytes</span><span class="p">)</span>
<span class="go">0.001</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check if alpha * A @ B + beta * C_copy = X holds.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atol</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">resolution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">A</span><span class="p">[:</span><span class="n">m</span><span class="p">,</span> <span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="o">@</span> <span class="n">B</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="p">:</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span>
<span class="gp">... </span>               <span class="n">beta</span> <span class="o">*</span> <span class="n">C_copy</span><span class="p">[:</span><span class="n">m</span><span class="p">,</span> <span class="p">:</span><span class="n">k</span><span class="p">],</span> <span class="n">X</span><span class="p">[:</span><span class="n">m</span><span class="p">,</span> <span class="p">:</span><span class="n">k</span><span class="p">],</span> <span class="n">atol</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="n">tol</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># When overwrite is set to True, check if X is indeed a view of C</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">may_share_memory</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In the above example, the object <code class="docutils literal notranslate"><span class="pre">mem</span></code> of class <a class="reference internal" href="detkit.Memory.html#detkit.Memory" title="detkit.Memory"><code class="xref py py-class docutils literal notranslate"><span class="pre">detkit.Memory</span></code></a>
tracks memory allocation. The peak of allocated memory during the matrix
multiplication is three orders of magnitude smaller than the size of one
of the matrices slices, confirming that no new array slice was created
during the operation.</p>
</dd></dl>

</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="detkit.solve_triangular.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">solve_triangular</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="detkit.electrocardiogram.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">electrocardiogram</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>


    <!-- Adobe Embed API -->
    
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>


  </body>
</html>